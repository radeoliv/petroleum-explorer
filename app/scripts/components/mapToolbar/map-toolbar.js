// Generated by CoffeeScript 1.7.1
(function () {
	$(function () {
		var initMapToggle,
			mapToolbar, mapToolbarButtons, mapToolbarIcon,
			setToggle, toolbarToggle, clearFields,
			mapToolbarContent;

		/**
		 * mapToolbarButtons finds all buttons in toolbar-buttons div.
		 * mapToolbarContent finds all the sections elements in sidebar-content-container
		 * these section elements will contain the actual implemented parts of selected function
		 * @type {*|jQuery|HTMLElement}
		 */
		mapToolbar = $(".mapToolbar");
		toolbarToggle = mapToolbar.find(".show-toolbar");
		mapToolbarIcon = toolbarToggle.find("i");
		mapToolbarButtons = mapToolbar.find(".toolbar-buttons button");
		mapToolbarContent = mapToolbar.find(".sidebar-content-container section").hide();
		mapToolbarAccordion = mapToolbar.find("#accordion");

		// Used to clear all the seach input
		mapToolbarClearSearch = mapToolbar.find("#clear-search");
		searchFields =
			[
				mapToolbar.find("#uwi"),
				mapToolbar.find("#lsd"),
				mapToolbar.find("#section"),
				mapToolbar.find("#township"),
				mapToolbar.find("#range"),
				mapToolbar.find("#meridian"),
				mapToolbar.find("#company"),
				mapToolbar.find("#status")
			];



		/**
		 * This function initializes mapToolbarButtons to hidden, and toggles
		 * the contents of the sidebar when called.
		 * @returns {*}
		 */
		initMapToggle = function () {
			mapToolbarButtons.hide();
			return toolbarToggle.on("click", function () {
				mapToolbarButtons.toggle();
				mapToolbarContent.slideUp();
				mapToolbarButtons.removeClass("active");
				return mapToolbarIcon.toggleClass("icon-expand icon-contract");
			});
		};

		/**
		 * This function is called to toggle content for a single toolbar button.
		 * It first hides any active content, and then uses the data-target attribute
		 * of selected button to find and show its corresponding content.
		 * TODO: use jQuery map with an array of jQuery objects for better selector speed
		 * @returns {*}
		 */
		setToggle = function () {
			return mapToolbarButtons.on("click", function () {

				mapToolbarContent.slideUp();
				mapToolbarButtons.removeClass("active");

				var targetSelector = $(this).attr("data-target");
				var target = $("."+targetSelector).slideDown();
				$(this).toggleClass("active");
			});
		};

		mapToolbarAccordion.accordion({
			collapsible: true,
			heightStyle: "content"
		});

		/*
		 * This function is called to clear all the search fields that the user might have filled.
		 */
		clearFields = function() {
			return mapToolbarClearSearch.on("click", function() {
				if(searchFields != undefined) {
					var i;
					for(i=0; i<searchFields.length; i++)
					{
						if(searchFields[i][0].id === "status")
						{
							if(searchFields[i][0].value != "none")
							{
								searchFields[i][0].value = "none";
							}
						}
						else
						{
							if(searchFields[i][0].value != "")
								searchFields[i][0].value = "";
						}
					}
					// Is necessary to call the change function of status, as the event is not triggered automatically.
					searchFields[--i].change();
				}
			})
		}

		initMapToggle();
		setToggle();
		clearFields();
	});

}).call(this);